1. 解答步骤

cat >> /etc/ansible/hosts <<-EOF
[promtail]
10.2.0.1
10.2.0.2
10.2.0.3
10.2.0.4
10.2.0.5
EOF

# 安装promtail的脚本
cat > install.sh <<-EOF
yum  install promtail  -y
if [ $? -eq 0 ];then 
    systemctl enable prometail --now 
else
    echo  "install  failed"
    return 2
fi
EOF

ansible  promtail  -m copy   -a  "src=install.sh dest=/tmp/"
ansible  promtail  -m shell  -a  "bash /tmp/install.sh"



2. 解答步骤
cat > docker-compose.yml <<-EOF
version: '3.7'
services:
    promtail:
      image: promtail
      container_name: promtail
      restart: always
      networks:
         - promtail
      volumes:
         - ./promtail:/mnt/config
      command:
         - -config.file=/mnt/config/promtail-config.yaml
networks:
    promtail:
      external: true
EOF

ansible  promtail  -m copy   -a  "src=docker-compose.yml dest=/tmp/"
ansible  promtail  -m shell  -a  "cd /tmp && docke-compose up -d"
